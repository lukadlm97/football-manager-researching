shapiro.test(greate_pass)
corrplot.mixed(cor.matri,lt.cex=0.75,number.cex=0.75)
library(corrplot)
full_players$TMG <- tmp+sms_coef
tmp <- norm(full_players$ValueAtTransferMarket)
sort_players <- read.csv(file="sort_by_value.csv")
str(sort_players)
sort_players$Games <- NA
sort_players$Goals <- NA
sort_players$Assists <- NA
sort_players$League <- NA
#SMS
sort_players$Games[1]<-31
sort_players$Goals[1]<-5
sort_players$Assists[1]<-7
sort_players$League[1]<-league_coef[1,2]
sort_players[2,]
#Kostic
sort_players$Games[2]<-40
sort_players$Goals[2]<-12
sort_players$Assists[2]<-15
sort_players$League[2]<-league_coef[1,2]
sort_players[3,]
#Gacinovic
sort_players$Games[3]<-27
sort_players$Goals[3]<-1
sort_players$Assists[3]<-2
sort_players$League[3]<-league_coef[1,2]
sort_players[4,]
#Radonjic
sort_players$Games[4]<-25
sort_players$Goals[4]<-6
sort_players$Assists[4]<-1
sort_players$League[4]<-league_coef[1,2]
sort_players[5,]
#Zivkovic
sort_players$Games[5]<-30
sort_players$Goals[5]<-0
sort_players$Assists[5]<-7
sort_players$League[5]<-league_coef[2,2]
sort_players[6,]
#Pavkov
sort_players$Games[6]<-25
sort_players$Goals[6]<-9
sort_players$Assists[6]<-3
sort_players$League[6]<-league_coef[4,2]
sort_players[7,]
#Ninkovic
sort_players$Games[7]<-23
sort_players$Goals[7]<-6
sort_players$Assists[7]<-10
sort_players$League[7]<-league_coef[6,2]
sort_players[8,]
#Ivanic
sort_players$Games[8]<-26
sort_players$Goals[8]<-1
sort_players$Assists[8]<-2
sort_players$League[8]<-league_coef[4,2]
sort_players[9,]
#Pantic
sort_players$Games[9]<-11
sort_players$Goals[9]<-0
sort_players$Assists[9]<-1
sort_players$League[9]<-league_coef[6,2]
sort_players[10,]
#Plavsic
sort_players$Games[10]<-24
sort_players$Goals[10]<-1
sort_players$Assists[10]<-5
sort_players$League[10]<-league_coef[3,2]
sort_players[11,]
#Simic
sort_players$Games[11]<-49
sort_players$Goals[11]<-7
sort_players$Assists[11]<-2
sort_players$League[11]<-league_coef[6,2]
sort_players[12,]
#Filipovic
sort_players$Games[12]<-46
sort_players$Goals[12]<-1
sort_players$Assists[12]<-2
sort_players$League[12]<-league_coef[5,2]
head(sort_players,12)
sort_players[13,]
#Filipovic
sort_players$Games[13]<-29
sort_players$Goals[13]<-5
sort_players$Assists[13]<-4
sort_players$League[13]<-league_coef[2,2]
sort_players[14,]
#Adzic
sort_players$Games[14]<-33
sort_players$Goals[14]<-9
sort_players$Assists[14]<-4
sort_players$League[14]<-league_coef[4,2]
sort_players[15,]
#Micin
sort_players$Games[15]<-18
sort_players$Goals[15]<-5
sort_players$Assists[15]<-1
sort_players$League[15]<-league_coef[4,2]
sort_players[16,]
#Djerlek
sort_players$Games[16]<-18
sort_players$Goals[16]<-1
sort_players$Assists[16]<-0
sort_players$League[16]<-league_coef[4,2]
sort_players[17,]
#Birmancevic
sort_players$Games[17]<-29
sort_players$Goals[17]<-4
sort_players$Assists[17]<-8
sort_players$League[17]<-league_coef[4,2]
sort_players[18,]
#Siladji
#Dodato ali nije kopirano
#Lutovac
sort_players$Games[19]<-11
sort_players$Goals[19]<-1
sort_players$Assists[19]<-4
sort_players$League[19]<-league_coef[4,2]
sort_players[20,]
#Mihajlovic
sort_players$Games[20]<-27
sort_players$Goals[20]<-11
sort_players$Assists[20]<-2
sort_players$League[20]<-league_coef[4,2]
sort_players[21,]
#Malbasic
sort_players$Games[21]<-26
sort_players$Goals[21]<-4
sort_players$Assists[21]<-4
sort_players$League[21]<-league_coef[6,2]
sort_players[22,]
#Polocevic
sort_players$Games[22]<-11
sort_players$Goals[22]<-2
sort_players$Assists[22]<-4
sort_players$League[22]<-league_coef[6,2]
sort_players[23,]
#Mihajlovic
sort_players$Games[23]<-24
sort_players$Goals[23]<-4
sort_players$Assists[23]<-5
sort_players$League[23]<-league_coef[5,2]
sort_players[24,]
#Hajdin
sort_players$Games[24]<-23
sort_players$Goals[24]<-1
sort_players$Assists[24]<-3
sort_players$League[24]<-league_coef[4,2]
sort_players[25,]
#Drazic
sort_players$Games[25]<-31
sort_players$Goals[25]<-7
sort_players$Assists[25]<-7
sort_players$League[25]<-league_coef[5,2]
summary(sort_players)
elim_c <- c(-1,-2,-3,-4,-5,-6,-7,-15)
cor.m <- cor(sp[,ec])
corrplot.mixed(cor.m,lt.cex=0.9,number.cex=0.9)
head(sort_players)
head(sort_players)
head(sort_players,30)
sort_players[18,]
sort_players[18,]
#Siladji
sort_players$Games[18]<-25
sort_players$Goals[18]<-13
sort_players$Assists[18]<-1
sort_players$League[18]<-league_coef[4,2]
head(sort_players,30)
sort_players[26,]
sort_players$Games[26]<-20
sort_players$Goals[26]<-6
sort_players$Assists[26]<-6
sort_players$League[26]<-league_coef[1,2]
sort_players[26,]
sort_players[27,]
sort_players$Games[27]<-20
sort_players$Goals[27]<-5
sort_players$Assists[27]<-4
sort_players$League[27]<-league_coef[5,2]
sort_players[27,]
sort_players[28,]
sort_players$Games[28]<-13
sort_players$Goals[28]<-0
sort_players$Assists[28]<-2
sort_players$League[28]<-league_coef[6,2]
sort_players[29,]
sort_players$Games[29]<-15
sort_players$Goals[29]<-1
sort_players$Assists[29]<-1
sort_players$League[29]<-league_coef[4,2]
sort_players[29,]
sort_players[30,]
#Gojkov
sort_players$Games[30]<-31
sort_players$Goals[30]<-10
sort_players$Assists[30]<-1
sort_players$League[30]<-league_coef[4,2]
sort_players[30,]
write.csv(sort_players,file="top_30_complete.csv",sep="\t",row.names=FALSE)
df <- read.csv("top_30_complete.csv")
df
write.csv(sort_players[1:30,],file="top_30_complete.csv",sep="\t",row.names=FALSE)
df <- read.csv("top_30_complete.csv")
df
df$ValueNorm <- norm(df$ValueAtTransferMarket)
summary(df$ValueNorm)
boxplot(df$ValueAtTransferMarket)
#outliers TMV
boxplot(df$ValueAtTransferMarket)
boxplot.stats(df$ValueAtTransferMarket)$stats
quantile(df$ValueAtTransferMarket,seq(0.7,1,0.025))
max_price <- quantile(df$ValueAtTransferMarket,0.725)
max_price
full_players$ValueAtTransferMarket[df$ValueAtTransferMarket>max_price]<-max_price
df$ValueAtTransferMarket[df$ValueAtTransferMarket>max_price]<-max_price
#outliers TMV
boxplot(df$ValueAtTransferMarket)
df$ValueNorm <- norm(df$ValueAtTransferMarket)
summary(df$ValueNorm)
coefs <- data.frame()
for(coef_games in seq(0.2,1.8,0.1)){
for(coef_goal in seq(0.2,1.8,0.1)){
for(coef_assist in seq(0.2,1.8,0.1)){
coefs <- rbind(coefs,c(coef_games,coef_assist,coef_goal))
}
}
}
names(coefs)<-c("games_c","assist_c","goal_c")
coefs
df[,-c(1,15)]
df[,c(1,15)]
eval_matrix <- data.frame()
df[,c(1,15)]
for(k in 1:4913){
performance_coefs <- df$Games*coefs$games_c[k]+df$Assists*coefs$assist_c[k]+df$Goals*coefs$goal_c[k]
performance_coefs <- norm(performance_coefs)
df$TMG <- df$ValueNorm+performance_coefs
cor.matri <- cor(df[,-c(1,15)])
eval_matrix <- rbind(eval_matrix,cor.matri[14,1:14])
}
nrow(eval_matrix)
eval_matrix
names(eval_matrix) <- names(df[,-c(1,15)])
names(eval_matrix) <- names(df[,-c(1,15,16)])
eval_matrix
eval_matrix$SumCorel <- rowSums(eval_matrix)
which.max(split_vars$SumCorel)
which.max(eval_matrix$SumCorel)
eval_matrix[1]
eval_matrix[1,]
performance_co <- df$Games*coefs$games_c[17]+df$Assists*coefs$assist_c[17]+df$Goals*coefs$goal_c[17]
games_c[17]
coefs$games_c[17]
performance_co
performance_co <- norm(performance_co)
performance_co
performance_co <- df$Games*coefs$games_c[17]+df$Assists*coefs$assist_c[17]+df$Goals*coefs$goal_c[17]
performance_co
boxplot(performance_co)
boxplot.stats(performance_co)
boxplot.stats(performance_co)$stats
quantile(performance_co,seq(0.9,1,0.025))
max_perf <- quantile(performance_co,0.95)
performance_co[performance_co>max_perf]<-max_perf
boxplot(performance_co)
str(df)
df$Performance <- performance_co
df$TMG <- df$ValueNorm+df$Performance
str(df)
df$Performance<- norm(performance_co)
df$TMG <- df$ValueNorm+df$Performance
str(df)
boxplot(df$TMG)
summary(df$TMG)
shapiro.test(df$TMG)
library(ggplot2)
ggplot(df,aes(x=1:30,y=TMG))+geom_line()
ggplot(df,aes(y=TMG))+geom_line()
best_class <- df[1:10,]
shapiro.test(best_class)
shapiro.test(best_class$TMG)
plot(best_class$TMG)
plot(best_class$TMG,best_class$Dribbling)
plot(best_class$Dribbling,best_class$TMG)
summary(best_class)
summary(best_class$TMG)
medium_class <- df[10:20,]
shapiro.test(medium_class$TMG)
summary(medium_class)
summary(medium_class$TMG)
low_class <- df[21:30,]
shapiro.test(low_class)
shapiro.test(low_class$TMG)
summary(low_class)
summary(low_class$Performance)
medium_class <- df[11:20,]
shapiro.test(medium_class$TMG)
summary(medium_class$TMG)
df[1]
df[1,]
df[2,]
df[3,]
df[4,]
df$fis1 <- NA
df$fis1[1]<-
df$fis1[4]<-1.17
df[1,]
df$fis1[1]<-1.48
df[2,]
df$fis1[2]<-1.18
df[3,]
df$fis1[3]<-1.18
df[5,]
df$fis1[5]<-1.17
df[6,]
df$fis1[6]<-1.37
df[7,]
df$fis1[7]<-1.46
df[8,]
df$fis1[8]<-1.49
df[9,]
df$fis1[9]<-1.48
df[10,]
df$fis1[10]<-1.18
df[1:10]
df$fis1
df[1:10,]
ncol(df)
df[1:10,c(2,19)]
df[1:10,c(1,2,19)]
df[11,]
df$fis1[11]<-1.5
df
library(ggplot2)
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_bar()
ggplot(df,aes(x=1:30,y=df$Age))+geom_bar()
ggplot(df,aes(x=1:30,y=df$Age))+geom_bar()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
write.csv(df,file="top_30_first_fis.csv",sep="\t",row.names=FALSE)
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
df[1,]
df$fis1[1]<-0.4
df[2,]
df$fis1[2]<-1.5
df[3,]
df[4,]
df[5,]
df$fis1[5]<-1.5
df[6,]
df$fis1[6]<-0.47
df[7,]
df$fis1[7]<-1.5
df[8,]
df[9,]
df[10,]
df$fis1[10]<-1.49
df[1:10,c(1,2,19)]
df[11,]
df$fis1[11]<-1.04
df[12,]
df$fis1[12]<-0.84
df[13,]
df$fis1[13]<-0.47
df[14,]
df[15,]
df$fis1[15]<-0.84
df[1:15,c(1,2,19)]
df$fis1[14]<-0.76
df[1:15,c(1,2,19)]
temp_15<- df[1:15,c(1,2,19)]
order(temp_15)
df_top_15 <- df[order(df$fis1,decreasing = TRUE)]
top_15 <- df[1:15,]
df_top_15 <- top_15[order(top_15$fis1,decreasing = TRUE)]
df_top_15
str(df)
df[16,]
df$fis1[16]<-0.81
df[17,]
df$fis1[17]<-0.84
df[17,]
df$fis1[17]<-0.81
df[18,]
df$fis1[18]<- 1.04
df[19,]
df$fis1[19]<- 0.47
df[20,]
df$fis1[20]<- 0.47
temp_20<- df[1:20,c(1,2,19)]
temp_20
df[21,]
df$fis1[21]<-1.5
df[22,]
df$fis[22] <- 1.5
df[23,]
df$fis[23] <- 1.5
df[24,]
df$fis[24] <- 0.47
df[25,]
df$fis[25] <- 1.5
temp_25<- df[1:25,c(1,2,19)]
temp_25
df$fis[22] <- 1.5
df[23,]
df$fis[23] <- 1.5
df[24,]
df$fis[24] <- 0.47
df[25,]
df$fis[25] <- 1.5
temp_25<- df[1:25,c(1,2,19)]
temp_25
df$fis1[25] <- 1.5
df$fis1[21]<-1.5
df[22,]
df$fis1[22] <- 1.5
df[23,]
df$fis1[23] <- 1.5
df[24,]
df$fis1[24] <- 0.47
df[25,]
df$fis1[25] <- 1.5
temp_25<- df[1:25,c(1,2,19)]
temp_25
df[26,]
df$fis[26] <- 1.04
df[27,]
df$fis[27] <- 0.81
df[28,]
df$fis[28] <- 1.04
df[29,]
df$fis1[29]<-0.47
df[30,]
df$fis[30] <- 0.47
temp_30<- df[1:30,c(1,2,19)]
temp_30
df$fis1[30] <- 0.47
df[26,]
df$fis1[26] <- 1.04
df[27,]
df$fis1[27] <- 0.81
df[28,]
df$fis1[28] <- 1.04
df[29,]
df$fis1[29]<-0.47
df[30,]
df$fis1[30] <- 0.47
temp_30<- df[1:30,c(1,2,19)]
temp_30
summary(df$fis1)
temp_30$NormalCategory <- NA
temp_30$NormalCategory[1:10] <- 'A'
temp_30$NormalCategory[11:20] <- 'B'
temp_30$NormalCategory[21:30] <- 'c'
temp_30
quantile(temp_30$fis1,0.33)
temp_30$fis1_category <- NA
temp_30$fis1_category[temp_30$fis1<0.81]<-'C'
temp_30
temp_30
quantile(temp_30$fis1,0.66)
temp_30$fis1_category[temp_30$fis1>0.81&temp_30$fis1<1.222]<-'B'
temp_30$fis1_category[temp_30$fis1>1.222]<-'A'
temp_30
summary(temp_30)
temp_30$NormalCategory<- as.factor(temp_30$NormalCategory)
temp_30$fis1_category <- as.factor(temp_30$fis1_category)
summary(temp_30)
temp_30$fis1_category[temp_30$fis1>=0.81&temp_30$fis1<1.222]<-'B'
temp_30$fis1_category <- as.factor(temp_30$fis1_category)
summary(temp_30)
temp_3
temp_30
conf.matrix <- table(true=temp_30$NormalCategory,predicted=temp_30$fis1_category)
conf.matrix
write.csv(temp_30,file="eval_fis1.csv",sep="\t",row.names = FALSE)
