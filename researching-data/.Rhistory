sort_players$Assists[28]<-2
sort_players$League[28]<-league_coef[6,2]
sort_players[29,]
sort_players$Games[29]<-15
sort_players$Goals[29]<-1
sort_players$Assists[29]<-1
sort_players$League[29]<-league_coef[4,2]
sort_players[29,]
sort_players[30,]
#Gojkov
sort_players$Games[30]<-31
sort_players$Goals[30]<-10
sort_players$Assists[30]<-1
sort_players$League[30]<-league_coef[4,2]
sort_players[30,]
write.csv(sort_players,file="top_30_complete.csv",sep="\t",row.names=FALSE)
df <- read.csv("top_30_complete.csv")
df
write.csv(sort_players[1:30,],file="top_30_complete.csv",sep="\t",row.names=FALSE)
df <- read.csv("top_30_complete.csv")
df
df$ValueNorm <- norm(df$ValueAtTransferMarket)
summary(df$ValueNorm)
boxplot(df$ValueAtTransferMarket)
#outliers TMV
boxplot(df$ValueAtTransferMarket)
boxplot.stats(df$ValueAtTransferMarket)$stats
quantile(df$ValueAtTransferMarket,seq(0.7,1,0.025))
max_price <- quantile(df$ValueAtTransferMarket,0.725)
max_price
full_players$ValueAtTransferMarket[df$ValueAtTransferMarket>max_price]<-max_price
df$ValueAtTransferMarket[df$ValueAtTransferMarket>max_price]<-max_price
#outliers TMV
boxplot(df$ValueAtTransferMarket)
df$ValueNorm <- norm(df$ValueAtTransferMarket)
summary(df$ValueNorm)
coefs <- data.frame()
for(coef_games in seq(0.2,1.8,0.1)){
for(coef_goal in seq(0.2,1.8,0.1)){
for(coef_assist in seq(0.2,1.8,0.1)){
coefs <- rbind(coefs,c(coef_games,coef_assist,coef_goal))
}
}
}
names(coefs)<-c("games_c","assist_c","goal_c")
coefs
df[,-c(1,15)]
df[,c(1,15)]
eval_matrix <- data.frame()
df[,c(1,15)]
for(k in 1:4913){
performance_coefs <- df$Games*coefs$games_c[k]+df$Assists*coefs$assist_c[k]+df$Goals*coefs$goal_c[k]
performance_coefs <- norm(performance_coefs)
df$TMG <- df$ValueNorm+performance_coefs
cor.matri <- cor(df[,-c(1,15)])
eval_matrix <- rbind(eval_matrix,cor.matri[14,1:14])
}
nrow(eval_matrix)
eval_matrix
names(eval_matrix) <- names(df[,-c(1,15)])
names(eval_matrix) <- names(df[,-c(1,15,16)])
eval_matrix
eval_matrix$SumCorel <- rowSums(eval_matrix)
which.max(split_vars$SumCorel)
which.max(eval_matrix$SumCorel)
eval_matrix[1]
eval_matrix[1,]
performance_co <- df$Games*coefs$games_c[17]+df$Assists*coefs$assist_c[17]+df$Goals*coefs$goal_c[17]
games_c[17]
coefs$games_c[17]
performance_co
performance_co <- norm(performance_co)
performance_co
performance_co <- df$Games*coefs$games_c[17]+df$Assists*coefs$assist_c[17]+df$Goals*coefs$goal_c[17]
performance_co
boxplot(performance_co)
boxplot.stats(performance_co)
boxplot.stats(performance_co)$stats
quantile(performance_co,seq(0.9,1,0.025))
max_perf <- quantile(performance_co,0.95)
performance_co[performance_co>max_perf]<-max_perf
boxplot(performance_co)
str(df)
df$Performance <- performance_co
df$TMG <- df$ValueNorm+df$Performance
str(df)
df$Performance<- norm(performance_co)
df$TMG <- df$ValueNorm+df$Performance
str(df)
boxplot(df$TMG)
summary(df$TMG)
shapiro.test(df$TMG)
library(ggplot2)
ggplot(df,aes(x=1:30,y=TMG))+geom_line()
ggplot(df,aes(y=TMG))+geom_line()
best_class <- df[1:10,]
shapiro.test(best_class)
shapiro.test(best_class$TMG)
plot(best_class$TMG)
plot(best_class$TMG,best_class$Dribbling)
plot(best_class$Dribbling,best_class$TMG)
summary(best_class)
summary(best_class$TMG)
medium_class <- df[10:20,]
shapiro.test(medium_class$TMG)
summary(medium_class)
summary(medium_class$TMG)
low_class <- df[21:30,]
shapiro.test(low_class)
shapiro.test(low_class$TMG)
summary(low_class)
summary(low_class$Performance)
medium_class <- df[11:20,]
shapiro.test(medium_class$TMG)
summary(medium_class$TMG)
df[1]
df[1,]
df[2,]
df[3,]
df[4,]
df$fis1 <- NA
df$fis1[1]<-
df$fis1[4]<-1.17
df[1,]
df$fis1[1]<-1.48
df[2,]
df$fis1[2]<-1.18
df[3,]
df$fis1[3]<-1.18
df[5,]
df$fis1[5]<-1.17
df[6,]
df$fis1[6]<-1.37
df[7,]
df$fis1[7]<-1.46
df[8,]
df$fis1[8]<-1.49
df[9,]
df$fis1[9]<-1.48
df[10,]
df$fis1[10]<-1.18
df[1:10]
df$fis1
df[1:10,]
ncol(df)
df[1:10,c(2,19)]
df[1:10,c(1,2,19)]
df[11,]
df$fis1[11]<-1.5
df
library(ggplot2)
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_bar()
ggplot(df,aes(x=1:30,y=df$Age))+geom_bar()
ggplot(df,aes(x=1:30,y=df$Age))+geom_bar()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
write.csv(df,file="top_30_first_fis.csv",sep="\t",row.names=FALSE)
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Age))+geom_line()
ggplot(df,aes(x=1:30,y=df$Crossing))+geom_line()
ggplot(df,aes(x=1:30,y=df$Acceleration))+geom_line()
ggplot(df,aes(x=1:30,y=df$Aggression))+geom_line()
ggplot(df,aes(x=1:30,y=df$Dribbling))+geom_line()
ggplot(df,aes(x=1:30,y=df$Passing))+geom_line()
df[1,]
df$fis1[1]<-0.4
df[2,]
df$fis1[2]<-1.5
df[3,]
df[4,]
df[5,]
df$fis1[5]<-1.5
df[6,]
df$fis1[6]<-0.47
df[7,]
df$fis1[7]<-1.5
df[8,]
df[9,]
df[10,]
df$fis1[10]<-1.49
df[1:10,c(1,2,19)]
df[11,]
df$fis1[11]<-1.04
df[12,]
df$fis1[12]<-0.84
df[13,]
df$fis1[13]<-0.47
df[14,]
df[15,]
df$fis1[15]<-0.84
df[1:15,c(1,2,19)]
df$fis1[14]<-0.76
df[1:15,c(1,2,19)]
temp_15<- df[1:15,c(1,2,19)]
order(temp_15)
df_top_15 <- df[order(df$fis1,decreasing = TRUE)]
top_15 <- df[1:15,]
df_top_15 <- top_15[order(top_15$fis1,decreasing = TRUE)]
df_top_15
str(df)
df[16,]
df$fis1[16]<-0.81
df[17,]
df$fis1[17]<-0.84
df[17,]
df$fis1[17]<-0.81
df[18,]
df$fis1[18]<- 1.04
df[19,]
df$fis1[19]<- 0.47
df[20,]
df$fis1[20]<- 0.47
temp_20<- df[1:20,c(1,2,19)]
temp_20
df[21,]
df$fis1[21]<-1.5
df[22,]
df$fis[22] <- 1.5
df[23,]
df$fis[23] <- 1.5
df[24,]
df$fis[24] <- 0.47
df[25,]
df$fis[25] <- 1.5
temp_25<- df[1:25,c(1,2,19)]
temp_25
df$fis[22] <- 1.5
df[23,]
df$fis[23] <- 1.5
df[24,]
df$fis[24] <- 0.47
df[25,]
df$fis[25] <- 1.5
temp_25<- df[1:25,c(1,2,19)]
temp_25
df$fis1[25] <- 1.5
df$fis1[21]<-1.5
df[22,]
df$fis1[22] <- 1.5
df[23,]
df$fis1[23] <- 1.5
df[24,]
df$fis1[24] <- 0.47
df[25,]
df$fis1[25] <- 1.5
temp_25<- df[1:25,c(1,2,19)]
temp_25
df[26,]
df$fis[26] <- 1.04
df[27,]
df$fis[27] <- 0.81
df[28,]
df$fis[28] <- 1.04
df[29,]
df$fis1[29]<-0.47
df[30,]
df$fis[30] <- 0.47
temp_30<- df[1:30,c(1,2,19)]
temp_30
df$fis1[30] <- 0.47
df[26,]
df$fis1[26] <- 1.04
df[27,]
df$fis1[27] <- 0.81
df[28,]
df$fis1[28] <- 1.04
df[29,]
df$fis1[29]<-0.47
df[30,]
df$fis1[30] <- 0.47
temp_30<- df[1:30,c(1,2,19)]
temp_30
summary(df$fis1)
temp_30$NormalCategory <- NA
temp_30$NormalCategory[1:10] <- 'A'
temp_30$NormalCategory[11:20] <- 'B'
temp_30$NormalCategory[21:30] <- 'c'
temp_30
quantile(temp_30$fis1,0.33)
temp_30$fis1_category <- NA
temp_30$fis1_category[temp_30$fis1<0.81]<-'C'
temp_30
temp_30
quantile(temp_30$fis1,0.66)
temp_30$fis1_category[temp_30$fis1>0.81&temp_30$fis1<1.222]<-'B'
temp_30$fis1_category[temp_30$fis1>1.222]<-'A'
temp_30
summary(temp_30)
temp_30$NormalCategory<- as.factor(temp_30$NormalCategory)
temp_30$fis1_category <- as.factor(temp_30$fis1_category)
summary(temp_30)
temp_30$fis1_category[temp_30$fis1>=0.81&temp_30$fis1<1.222]<-'B'
temp_30$fis1_category <- as.factor(temp_30$fis1_category)
summary(temp_30)
temp_3
temp_30
conf.matrix <- table(true=temp_30$NormalCategory,predicted=temp_30$fis1_category)
conf.matrix
write.csv(temp_30,file="eval_fis1.csv",sep="\t",row.names = FALSE)
top_30_first_fis <- read_csv("top_30_first_fis.csv")
top_30_first_fis <- read,csv("top_30_first_fis.csv")
top_30_first_fis <- read.csv("top_30_first_fis.csv")
str(top_30_first_fis)
top_30_first_fis[1,]
top_30_first_fis[2,]
top_30_first_fis[2,]
top_30_first_fis[1,]
top_30_first_fis[2,]
top_30_first_fis[3,]
top_30_first_fis[13,]
top_30_first_fis[1,]
top_30_first_fis[1,]
top_30_first_fis$fis2 <-NA
top_30_first_fis$fis2[1]<-1.48
top_30_first_fis[2,]
top_30_first_fis$fis2[2]<-1.5
str(top_30_first_fis)
top_30_first_fis[3,]
top_30_first_fis$fis2[3]<-1.5
top_30_first_fis[4,]
top_30_first_fis$fis2[4]<-1.5
top_30_first_fis[5,]
top_30_first_fis$fis2[5]<-1.5
top_30_first_fis[6,]
top_30_first_fis$fis2[6]<-1.5
top_30_first_fis[7,]
top_30_first_fis$fis2[7]<-1.48
top_30_first_fis[8,]
top_30_first_fis[9,]
top_30_first_fis$fis2[9]<-1.5
top_30_first_fis[10,]
top_30_first_fis$fis2[10]<-1.46
top_30_first_fis[11,]
top_30_first_fis$fis2[11]<-0.47
top_30_first_fis[12,]
top_30_first_fis$fis2[12]<-0.767
top_30_first_fis[13,]
top_30_first_fis$fis2[13]<-0.847
top_30_first_fis[14,]
top_30_first_fis$fis2[14]<-0.844
top_30_first_fis$fis2[13]<-0.847
top_30_first_fis$fis2[12]<-0.767
top_30_first_fis[12,]
top_30_first_fis[13,]
top_30_first_fis[14,]
top_30_first_fis[15,]
top_30_first_fis$fis2[15]<-1.5
top_30_first_fis[15,]
top_30_first_fis$fis2[15]<-0.515
top_30_first_fis[16,]
top_30_first_fis$fis2[16]<-0.818
top_30_first_fis[17,]
top_30_first_fis$fis2[17]<-0.67
top_30_first_fis[18,]
top_30_first_fis$fis2[18]<-0.466
top_30_first_fis[19,]
top_30_first_fis$fis2[19]<-1.04
top_30_first_fis[20,]
top_30_first_fis$fis2[20]<-0.67
top_30_first_fis[21,]
top_30_first_fis$fis2[21]<-1.5
top_30_first_fis[22,]
top_30_first_fis$fis2[22]<-1.49
top_30_first_fis[23,]
top_30_first_fis$fis2[23]<-1.48
top_30_first_fis[24,]
top_30_first_fis$fis2[24]<-1.44
top_30_first_fis[25,]
top_30_first_fis$fis2[25]<-1.48
top_30_first_fis[26,]
top_30_first_fis$fis2[26]<-0.467
top_30_first_fis[27,]
top_30_first_fis$fis2[27]<-0.467
top_30_first_fis[28,]
top_30_first_fis$fis2[28]<-1.07
top_30_first_fis[29,]
top_30_first_fis$fis2[29]<-0.843
top_30_first_fis[30,]
top_30_first_fis$fis2[30]<-1.48
str(top_30_first_fis)
fis_import <- c(1,2,20)
top_30_first_fis[fis_import]
top_30_first_fis$fis2[8]<-0.838
top_30_first_fis[fis_import]
df <- top_30_first_fis
df[1,]
df$fis1[1]<-0.4
df[2,]
df$fis1[2]<-1.5
df[3,]
df$fis1[3]<-1.5
df[4,]
df$fis1[4]<-1.5
df[5,]
df$fis1[5]<-1.5
df[6,]
df$fis1[6]<-0.47
df[7,]
df$fis1[7]<-1.5
df[8,]
df$fis1[8]<-0.47
df[9,]
df$fis1[9]<-0.486
df[10,]
df$fis1[10]<-1.49
df[11,]
df$fis1[11]<-1.04
df[12,]
df$fis1[12]<-0.84
df[13,]
df$fis1[13]<-0.47
df[14,]
df$fis1[14]<-0.76
df[15,]
df$fis1[15]<-0.84
df[16,]
df$fis1[16]<-0.81
df[17,]
df$fis1[17]<-0.81
df[18,]
df$fis1[18]<- 1.04
df[19,]
df$fis1[19]<- 0.47
df[20,]
df$fis1[20]<- 0.47
top_15 <- df[1:15,]
df[21,]
df$fis1[21]<-1.5
df[22,]
df$fis1[22] <- 1.5
df[23,]
df$fis1[23] <- 1.5
df[24,]
df$fis1[24] <- 0.47
df[25,]
df$fis1[25] <- 1.5
df[26,]
df$fis1[26] <- 1.04
df[27,]
df$fis1[27] <- 0.81
df[28,]
df$fis1[28] <- 1.04
df[29,]
df$fis1[29]<-0.47
df[30,]
df$fis1[30] <- 0.47
fis_import <- c(1,2,19,20)
top_30_first_fis[fis_import]
top_30_first_fis<-df
top_30_first_fis[fis_import]
top_30_first_fis$NormCategory <- NA
top_30_first_fis$NormCategory[1:10,]<- 'A'
top_30_first_fis$NormCategory[1:10,]<- 'A'
top_30_first_fis$NormCategory[1:10]<- 'A'
top_30_first_fis$NormCategory[11:20]<-'B'
top_30_first_fis$NormCategory[21:30]<-'C'
fis1_33 <- quantile(top_30_first_fis$fis1,0.33)
fis1_66<-quantile(top_30_first_fis$fis1,0.66)
top_30_first_fis$FirstCategory<-ifelse(test=top_30_first_fis$fis1<fis1_33,yes='A')
str(top_30_first_fis)
top_30_first_fis$NormCategory<-as.factor(top_30_first_fis$NormCategory)
str(top_30_first_fis)
top_30_first_fis$FirstFis <- NA
top_30_first_fis$FirstFis[top_30_first_fis$fis1<=fis1_33]<-'C'
top_30_first_fis$FirstFis[top_30_first_fis$fis1>=fis1_33&top_30_first_fis$fis1<=fis1_66]<-'B'
top_30_first_fis$FirstFis[top_30_first_fis$fis1>=fis1_66]<-'A'
top_30_first_fis$FirstFis <- top_30_first_fis$FirstFis
str(top_30_first_fis)
top_30_first_fis$FirstFis <- as.factor(top_30_first_fis$FirstFis)
str(top_30_first_fis)
fis2_33 <- quantile(top_30_first_fis$fis2,0.33)
fis2_66<-quantile(top_30_first_fis$fis2,0.66)
top_30_first_fis$SecoundFis <- NA
top_30_first_fis$SecoundFis[top_30_first_fis$fis2<=fis2_33]<-'C'
top_30_first_fis$SecoundFis[top_30_first_fis$fis2>=fis2_33&top_30_first_fis$fis2<=fis2_66]<-'B'
top_30_first_fis$SecoundFis[top_30_first_fis$fis2>=fis2_66]<-'A'
top_30_first_fis$SecoundFis[top_30_first_fis$fis2>=fis2_66]<-'A'
top_30_first_fis$SecoundFis <- as.factor(top_30_first_fis$SecoundFis)
fis2_66<-quantile(top_30_first_fis$fis2,0.66)
str(top_30_first_fis)
top_30_first_fis[fis_import]
top_30_first_fis[,c(1,2,19,20,21,22,23)]
secound_cm <- table(true=top_30_first_fis[,21],predicted=top_30_first_fis[,23])
secound_cm
first_cm <- table(true=top_30_first_fis[,21],predicted=top_30_first_fis[,22])
first_cm
